<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!-- <link rel="icon" href="<%= BASE_URL %>favicon.ico"> -->
    <link rel="stylesheet" href="https://demo.flatlogic.com/sing-app/html-bs4/css/application.min.css">
    
    <title></title>
    <meta name="description" content="Free & Open Source Vue.js Admin Dashboard Template built with vue-router, vuex and bootstrap 4">
    <meta name="keywords" content="vue admin, vue admin template, vue dashboard, free vue.js admin dashboard, open source vue admin dashboard, vue template">
    <meta name="author" content="Flatlogic LLC">
  </head>
  
  <script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.3.0.min.js"></script>
  <!-- <script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script> -->
  <script type="text/javascript" src="https://online.tableau.com/javascripts/api/tableau-2.min.js"></script>
  
  
  <script src="https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit" async defer></script> 
  <body>
    <noscript>
      <strong>We're sorry but vue-cli doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app">
        <vue-snotify></vue-snotify>
    </div>
    <!-- built files will be auto injected -->
    <script>
      ///JS FOR HANDEL CONTENT TABLEAU
      var viz;
      var workbook;
      var containerDiv;
      function initViz(params, sheetexc) {
        dispose();
            var containerDiv = document.getElementById("refs"),
                url = params,
                options = {
                    hideTabs: true,
                    hideToolbar: true,
                   onFirstInteractive: function() {
                    workbook = viz.getWorkbook();
                    dash = viz.getWorkbook().getActiveSheet();
                    workbook.activateSheetAsync(dash)
                      .then(function(dashboard) {
                        var worksheets = dashboard.getWorksheets();
                        var sheetNames = [];
                        for (var i = 0, len = worksheets.length; i < len; i++) {
                          var sheet = worksheets[i];
                          sheetNames.push(sheet.getName());
                        }
                        var sel = document.getElementById('SheetList');
                        var fragment = document.createDocumentFragment();
                        if(sheetexc !=null){
                            sheetNames = sheetexc;
                        }
                        sheetNames.forEach(function(sheetName, index) {
                          var opt = document.createElement('option');
                          var shettemp = sheetName.length;
                          if(shettemp == 2){
                              opt.innerHTML = sheetName[1];
                              opt.value = sheetName[0];
                          } else {
                              opt.innerHTML = sheetName;
                              opt.value = sheetName;
                          }
                          fragment.appendChild(opt);
                        });
                        sel.appendChild(fragment);
                      });
                  }
                };
            viz = new tableau.Viz(containerDiv, url, options); 
        }
        function exportToPDF() {
            viz.showExportPDFDialog();
        }
        function getVizData() {
             options = {
              
                maxRows: 0, // Max rows to return. Use 0 to return all rows
                ignoreAliases: false,
                ignoreSelection: true,
                includeAllColumns: false
              };
              sheet = viz.getWorkbook().getActiveSheet();
              //if active tab is a worksheet, get data from that sheet
              if (sheet.getSheetType() === 'worksheet') {
                sheet.getUnderlyingDataAsync(options).then(function(t) {
                  buildMenu(t);
                });
                //if active sheet is a dashboard get data from a specified sheet
              } else {
                worksheetArray = viz.getWorkbook().getActiveSheet().getWorksheets();
                  
                if(document.getElementById("SheetList") != null){
                    for (var i = 0; i < worksheetArray.length; i++) {
                      worksheet = worksheetArray[i];
                      sheetName = worksheet.getName();
                          //get user's selection from dropdown of sheets
                          var selectedVal = document.getElementById("SheetList").value;
                          //get the data from the selected sheet
                          if (sheetName == selectedVal) {
                            viz.showExportCrossTabDialog(sheetName);
                          }
                    }
                } else {
                       
                    viz.showExportCrossTabDialog();
                }
              }
        }
        function dispose() {
            if (viz == null) {
                console.log("No Viz has been rendered, so I can't dispose anything");
                return;
            } else {
                viz.dispose();
            }
        }
        function vizResize() {
            var width = document.getElementById("resizeWidth").value;
            var height = document.getElementById("resizeHeight").value;
              viz.setFrameSize(parseInt('100%', 10), parseInt('100%', 10));
            }
    </script>
  </body>
  



</html>
